---
title: '윈도우10 파티션 만들기'
excerpt: '윈도우10에서 파티션 만들어 보고 공간이 부족할 시 해결방안을 알아보겠습니다.'
date: 2020-03-28
last_modified_at: 2020-03-31T16:43:59

category:
 - linux

tags:
 - linux
 - ubuntu
 - partition
 - dual booting
---

저는 surface pro 4를 사용하고 있습니다.

윈도우 계정 기록을 보니 2015년 12월 30일에 사서 5년째 사용 중인데 CPU i5-6300U / RAM 4GB / SSD 128GB 라는 다소 아쉬운 성능으로 그럭저럭 잘 쓰고 있었습니다.

이번에 모종의 기회(?)에 의해서 우분투를 설치하여 듀얼 부팅을 해보려고 합니다.

이 글을 쓰기 전에 이미 한 차례 우분투를 설치해봤지만 역시나 여러 문제가 있더군요...

웹캠이 안된다던지, 터치가 안된다던지, 블루투스가 계속 끊긴다던지, ...

surface가 리눅스와 궁합이 좋은 기기는 아닌 것 같아서 무지 고생할 것 같은 예감은 드는데 그래도 길게 보고 블로그에 글도 남기면서 나름 쓸 수 있는 정도까지 만들어보고자 합니다.



## 파티션이란?
파티션은 하나의 물리적 저장소를 여러 부분으로 분할한 논리적 공간을 의미합니다.

***리눅스를 설치하기 전에 왜 굳이 파티션을 나눠야 할까? 그냥 만들면 안되나?*** 라고 잠깐 생각했었는데 멍청한 질문이었던 것 같습니다.

파티션 없이 설치하면 윈도우 입장에선 리눅스 파일시스템에서 관리하는 데이터인지 알 길이 없으니 그 위에 막 덮어쓸 것이고 반대의 경우도 마찬가지일 테니까요. 

또한 이번에 파티션을 나누면서 사용자가 설치하거나 생성하진 않았지만 윈도우가 직접 위치를 고정해놓고 사용하는 데이터를 눈으로 확인해봤습니다. 

분명 운영체제 시간에 배웠던 것 같은데 '아 그렇구나~' 하고 넘어간 지식이라서 그런지 까먹고 있다가 실제로 보면서 '아 맞다 그런게 있었지'하고 떠올렸습니다.



## 파티션 생성
그렇다면 본격적으로 파티션 생성하는 법을 알아보겠습니다.

작업은 Windows 10 Version 1909에서 진행하였습니다.

![01][search]

우선 `설정`이나 `시작` 창에서 파티션을 검색해서 파티션 설청 창에 들어갑니다.

![02][disk management]

그러면 위와 같이 디스크 관리 창이 뜹니다.

OS에서 인식하고 있는 드라이브를 볼 수 있으며 윈도우가 깔려있는 저의 SSD는 이미 EFI 시스템 파티션이나 복구 파티션이란 이름으로 조금씩 쪼개져있는 걸 볼 수 있습니다.

아, 참고로 `UBUNTU 18_0(D:)` 라고 써있는 디스크 1은 우분투를 설치하기 위해 만들어 놓은 USB입니다!

여기서 나누고 싶은 공간에 우클릭을 하고 `볼륨 축소`를 눌러주시면 됩니다.

저의 경우에는 SSD 하나만 쓰기 때문에 `Local Disk (C:)` 말곤 선택의 여지가 없습니다.

![03][shrink]

볼륨 축소를 눌러주시면 **축소 공간 쿼리 중** 이라는 메세지가 뜰텐데 다음 창으로 넘어가기까지 시간이 다소 걸립니다.

그 후에 위 사진처럼 축소할 공간을 설정할 수 있는 창이 나옵니다.

`축소할 공간 입력`에 원하시는 만큼의 크기를 입력하고나서 `축소` 버튼을 눌러줍니다.

**축소할 공간의 단위는 MB**라는 점 유의하시기 바랍니다.

간혹 storage에 남는 공간에 비해서 `사용할 수 있는 축소 공간 크기`가 터무니 없이 작은 경우가 있습니다. 이것에 대한 해결책은 아래에서 다루겠습니다.

![04][done]

그러면 보시는 바와 같이 파티션이 나눠졌습니다.



## 볼륨 축소를 위한 공간 확보

제가 맨 처음 볼륨 축소를 시도했을 땐 70GB 이상이 비어있었음에도 9GB 정도밖에 축소를 할 수 없었습니다. 

대부분 로컬 디스크에서 표시된 여유 공간에 비해 축소 가능한 공간이 많이 부족할 것입니다.

![03][shrink]

아까 축소할 공간을 입력했던 창입니다. `이동할 수 없는 파일이 있는 지점을 벗어나 볼륨을 축소할 수 없습니다`라고 써있는 걸로 보아 위치를 고정하고 사용해야 하는 데이터들이 있고 이들을 피해서 여유공간을 계산하다보니 실제 자투리 공간의 크기가 작아진 것으로 추측이 됩니다.

이를 해결하기 위해서 **응용 프로그램 로그의 'defrag' 이벤트**를 확인하고 다음 부분들을 점검해 보겠습니다.

1. [가상 메모리](#가상-메모리-비활성화)
1. [복원 지점](#복원-지점-삭제)
1. [최대 절전 모드](#최대-절전-모드-해제)



## 가상 메모리 비활성화

![05][event viewer]

`시작` 창에서 `이벤트 뷰어`를 검색하여 실행합니다.

![06][pagefile]

`window 로그`>`응용 프로그램`으로 들어가서 `이벤트 ID`가 259인 이벤트의 로그를 확인합니다.

`pagefile.sys`라는 파일을 이동할 수 없었다고 나옵니다. `pagefile.sys`는 윈도우가 **가상 메모리**를 운용하기 위해 페이징에 대한 정보를 저장해둔 파일입니다.

잠시 가상 메모리에 대해서 짧고 얕게 설명하겠습니다.

컴퓨터는 프로그램을 주기억장치에 가져와 프로세스의 형태로 실행합니다.

이때 주기억장치의 크기가 작아 프로그램의 모든 데이터를 올릴 수 없더라도 우리는 프로그램이 중단되거나 하는 경우를 거의 경험하지 못합니다. 가상 메모리가 실제 메모리를 도와서 실제 메모리에 미처 못 올린 부분들을 갖고 있기 때문입니다.

그렇게 주기억장치에서 프로그램을 돌리다보면 자신에게 올려지지 않은 부분의 데이터가 필요한 상황이 올 것입니다. 그때 가상 메모리에 올려진 데이터와 자신에게 있던 데이터를 바꾸는 것입니다.

이런 가상 메모리는 HDD나 SSD와 같은 보조 기억장치에 마련되어 있는데 가상 메모리가 차지하고 있는 공간을 정리하여 파티션을 위한 공간을 마련해 보겠습니다.

![07][vm]

**제어판\시스템 및 보안\시스템**을 엽니다. 저같은 경우는 `파일 탐색기`에서 `내 PC`를 우클릭하고 속성을 눌러 접근하는 편입니다.

그 다음 왼쪽의 `고급 시스템 설정`을 누르면 열리는 `시스템 속성` 창에서 `고급` 탭을 선택합니다.

그러면 사진에서 보는 바와 같이 `성능` 칸에서 가상 메모리를 관리하는 것을 알 수 있습니다. `설정`을 눌러줍니다.

![08][vm change]

가상 메모리의 페이징 파일 크기를 보여줍니다. `변경`을 클릭합니다.

![09][vm none]

`모든 드라이브에 대한 페이징 파일 크기 자동 관리`를 선택 해제합니다.
그 후에 `페이징 파일 없음`을 선택하고 `설정`을 누릅니다.

![10][vm done]

재부팅을 하고나면 페이징 파일의 크기가 0인 것을 확인할 수 있습니다.

가상 메모리는 파티션을 만들고난 뒤에 역순으로 다시 활성화 해주면 됩니다.



## 복원 지점 삭제

![11][volume]

가상 메모리 파일을 삭제하고 볼륨 축소를 시도해보니 이번에는 `System Volume Information`이라는 파일이 문제라고 합니다.

`System Volume Information`은 윈도우의 복원 지점을 저장하는 파일입니다.

윈도우는 복원 지점을 설정하였다가 오류가 발생했을 시 지정된 순간의 상태로 되돌아갈 수 있는 기능을 제공합니다. 

복원을 위한 백업 파일이 저장공간을 차지하게 되어 볼륨 축소를 위한 공간이 줄어드는 것입니다.

![12][restore]

가상 메모리를 삭제할 때와 마찬가지로 **제어판\시스템 및 보안\시스템**에서 `고급 시스템` 설정을 누릅니다.

그리고 이번에는 `시스템 속성` 창에서 `시스템 보호`>`구성`으로 들어갑니다.

![13][restore del]

위와 같이 `시스템 보호 사용 안 함`을 선택하고 `삭제`를 눌러 기존에 존재하는 복원 지점을 모두 삭제합니다.



## 최대 절전 모드 해제

![14][hiberfil]
이번에는 `hiberfil.sys`라는 파일에 대한 로그가 기록되었습니다.

`hiberfil.sys`는 윈도우가 **최대 절전 모드**가 되기 직전의 컴퓨터 상태를 저장하여 진행 중이던 작업들의 데이터가 날아가지 않도록 도와주는 파일입니다.

최대 절전 모드를 끄는 것으로 `hiberfil.sys`파일을 없애보도록 하겠습니다.

![15][cmd]
먼저 cmd창을 **관리자 권한**으로 실행합니다. 

관리자 권한으로 실행하지 않을 경우 최대 절전 모드를 종료하는 명령은 거절당합니다.

![16][hoff]

cmd창에 `powercfg -h off`라는 명령어를 입력하면 최대 절전 모드가 해제됩니다.

파티션을 구성한 뒤에 해당 기능을 다시 활성화하고 싶다면 `powercfg -h on`을 입력하면 됩니다.

## References
> [윈도즈 볼륨축소](https://sdev.tistory.com/177 'https://sdev.tistory.com/177')


[search]: /assets/images/2020-03-23-partition/partition01-search.jpg
[disk management]: /assets/images/2020-03-23-partition/partition02-disk-mangement.jpg
[shrink]: /assets/images/2020-03-23-partition/partition03-shrink.jpg
[done]: /assets/images/2020-03-23-partition/partition04-done.jpg
[event viewer]: /assets/images/2020-03-23-partition/partition05-event-viewer.jpg
[pagefile]: /assets/images/2020-03-23-partition/partition06-pagefile.jpg
[vm]: /assets/images/2020-03-23-partition/partition07-vm.jpg
[vm change]: /assets/images/2020-03-23-partition/partition08-vm-change.jpg
[vm none]: /assets/images/2020-03-23-partition/partition09-vm-none.jpg
[vm done]: /assets/images/2020-03-23-partition/partition10-vm-done.jpg
[volume]: /assets/images/2020-03-23-partition/partition11-volume.jpg
[restore]: /assets/images/2020-03-23-partition/partition12-restore.jpg
[restore del]: /assets/images/2020-03-23-partition/partition13-restore-del.jpg
[hiberfil]: /assets/images/2020-03-23-partition/partition14-hiberfil.jpg
[cmd]: /assets/images/2020-03-23-partition/partition15-cmd.jpg
[hoff]: /assets/images/2020-03-23-partition/partition16-hoff.jpg